<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>js调用java</title>
  <script>
    function connectWebViewJavascriptBridge ( callback ) {
      if ( window.WebViewJavascriptBridge ) {
        callback( WebViewJavascriptBridge )
      } else {
        document.addEventListener(
          'WebViewJavascriptBridgeReady'
          , function() {
            callback( WebViewJavascriptBridge )
          },
          false );
      }
    }

    connectWebViewJavascriptBridge( function( bridge ) {
      bridge.init();
      bridge.registerHandler( "functionInJs", function( data, responseCallback ) {
        document.getElementById( "show" ).innerHTML = ("data from Android: = " + data);
        responseCallback( "HTML返回的数据" )
      } );
    } );

    function onOpen () {
      var str1 = document.getElementById( "text1" ).value;
      var str2 = document.getElementById( "text2" ).value;
      var data = "name=" + str1 + ",pass=" + str2;
      //call native method
      window.WebViewJavascriptBridge.callHandler(
        'functionOpen'
        , { 'param':data }
        , function( responseData ) {
          //document.getElementById("show").innerHTML = "send get responseData from java, data = " + responseData;
        }
      );
    }

    function testClick () {
      var str1 = document.getElementById( "text1" ).value;
      var str2 = document.getElementById( "text2" ).value;
      //发送消息给java本地代码
      var data = { id:1, content:"这是一个图片 <img src=\"a.png\"/> test\r\nhahaha" };
      window.WebViewJavascriptBridge.send(
        data,
        function( responseData ) {
          document.getElementById( "show" ).innerHTML = "repsonseData from Android, data = " + responseData
        }
      );
    }

    function testClick1 () {
      var str1 = document.getElementById( "text1" ).value;
      var str2 = document.getElementById( "text2" ).value;
      var data = "name=" + str1 + ",pass=" + str2;
      //call native method
      window.WebViewJavascriptBridge.callHandler(
        'submitFromWeb'
        , { 'param':data }
        , function( responseData ) {
          document.getElementById( "show" ).innerHTML = "send get responseData from java, data = " + responseData
        }
      );
    }
  </script>
</head>
<body>

<p>
  <xmp id="show"></xmp>
</p>
<p>
  <xmp id="init"></xmp>
</p>
<p>
  <input type="text" id="text1" value="用户名(username)" />
</p>
<p>
  <input type="text" id="text2" value="password" />
</p>
<p>
  <input type="button" id="enter" value="发消息给Native" onclick="testClick();" />
</p>
<p>
  <input type="button" id="enter1" value="调用Native方法" onclick="testClick1();" />
</p>
<p>
  <input type="button" id="enter2" value="显示源代码" />
</p>
<p>
  <input type="button" id="open" value="打开文件" onclick="onOpen();" />
</p>

</body>
</html>